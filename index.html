<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>投资模拟器</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            line-height: 1.6;
            color: #1a1a1a;
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        header {
            padding: 40px 0;
            border-bottom: 1px solid #e5e7eb;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-left h1 {
            font-size: 2rem;
            font-weight: 600;
            margin: 0;
            color: #1f2937;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .lang-toggle {
            background: #f3f4f6;
            border: 1px solid #d1d5db;
            color: #374151;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 500;
            transition: all 0.2s ease;
        }

        .lang-toggle:hover {
            background: #e5e7eb;
            border-color: #9ca3af;
        }

        .header-divider {
            width: 1px;
            height: 16px;
            background: #d1d5db;
        }

        .github-link {
            display: flex;
            align-items: center;
            gap: 6px;
            background: #1f2937;
            border: 1px solid #374151;
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            text-decoration: none;
            font-size: 0.875rem;
            font-weight: 500;
            transition: all 0.2s ease;
        }

        .github-link:hover {
            background: #374151;
            color: white;
        }

        main {
            padding: 60px 0;
        }

        .calculator-section {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 40px;
            margin-bottom: 40px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }

        .input-group {
            margin-bottom: 40px;
        }

        .input-group label {
            display: block;
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 12px;
            color: #2c3e50;
        }

        .amount-input {
            width: 100%;
            padding: 16px 24px;
            font-size: 1.5rem;
            border: 2px solid #e1e8ed;
            border-radius: 6px;
            background: #f8fafc;
            transition: all 0.3s ease;
            font-family: 'JetBrains Mono', monospace;
            text-align: center;
        }

        .amount-input:focus {
            outline: none;
            border-color: #667eea;
            background: white;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .slider-container {
            margin: 30px 0;
        }

        .slider-wrapper {
            position: relative;
            margin: 20px 0;
        }

        .slider {
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: #e1e8ed;
            outline: none;
            -webkit-appearance: none;
            appearance: none;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(102, 126, 234, 0.3);
            transition: all 0.2s ease;
        }

        .slider::-webkit-slider-thumb:hover {
            transform: scale(1.2);
            box-shadow: 0 6px 12px rgba(102, 126, 234, 0.4);
        }

        .slider::-moz-range-thumb {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
            border: none;
            box-shadow: 0 4px 8px rgba(102, 126, 234, 0.3);
        }

        .slider-value {
            text-align: center;
            font-size: 1.8rem;
            font-weight: 700;
            color: #667eea;
            margin-top: 15px;
            font-family: 'JetBrains Mono', monospace;
        }

        .results {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin: 50px 0;
        }

        .result-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 4px 16px rgba(102, 126, 234, 0.2);
            transition: transform 0.3s ease;
        }

        .result-card:hover {
            transform: translateY(-5px);
        }

        .result-card.savings {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            color: #8B4513;
        }

        .result-card.speculation {
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);
            color: #8B0000;
        }

        .result-title {
            font-size: 1.1rem;
            font-weight: 500;
            margin-bottom: 15px;
            opacity: 0.9;
        }

        .result-amount {
            font-size: 2.5rem;
            font-weight: 700;
            font-family: 'JetBrains Mono', monospace;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .result-desc {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .comparison-section {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 40px;
            margin-bottom: 40px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }

        .comparison-title {
            text-align: center;
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 30px;
            color: #2c3e50;
        }

        .chart-container {
            height: 300px;
            background: #f8fafc;
            border-radius: 6px;
            display: flex;
            align-items: end;
            justify-content: space-around;
            padding: 40px 20px;
            margin: 30px 0;
        }

        .chart-bar {
            width: 80px;
            background: linear-gradient(to top, #667eea, #764ba2);
            border-radius: 6px 6px 0 0;
            position: relative;
            transition: all 0.8s ease;
            min-height: 20px;
        }

        .chart-bar.savings {
            background: linear-gradient(to top, #ffecd2, #fcb69f);
        }

        .chart-bar.speculation {
            background: linear-gradient(to top, #ff9a9e, #fecfef);
        }

        .chart-label {
            position: absolute;
            bottom: -40px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.9rem;
            font-weight: 600;
            text-align: center;
            width: 100px;
        }

        .chart-value {
            position: absolute;
            top: -35px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.8rem;
            font-weight: 700;
            font-family: 'JetBrains Mono', monospace;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            white-space: nowrap;
        }

        .insights {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 6px;
            padding: 30px;
            margin: 40px 0;
        }

        .insights-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #856404;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .insights-list {
            list-style: none;
        }

        .insights-list li {
            padding: 8px 0;
            color: #856404;
            display: flex;
            align-items: flex-start;
            gap: 12px;
        }

        .insights-list li::before {
            content: "💡";
            flex-shrink: 0;
        }

        /* FAQ最佳实践设计 */
        .faq-section {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 40px;
            margin: 40px 0;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }

        .faq-title {
            text-align: center;
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 30px;
            color: #2c3e50;
        }

        .faq-item {
            border-bottom: 1px solid #e5e7eb;
            margin-bottom: 0;
            background: white;
            border-radius: 6px;
            margin-bottom: 8px;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }

        .faq-item:last-child {
            border-bottom: none;
        }

        .faq-question {
            background: none;
            border: none;
            width: 100%;
            text-align: left;
            padding: 20px 24px;
            font-size: 1.1rem;
            font-weight: 600;
            color: #2c3e50;
            cursor: pointer;
            display: grid;
            grid-template-columns: 1fr 44px;
            align-items: center;
            gap: 16px;
            transition: all 0.2s ease;
            min-height: 44px;
        }

        .faq-question:hover {
            background: #f9fafb;
            color: #667eea;
        }

        .faq-question:focus {
            outline: 2px solid #667eea;
            outline-offset: -2px;
        }

        .faq-icon {
            width: 20px;
            height: 20px;
            transition: transform 0.3s ease;
            color: #6b7280;
            justify-self: center;
            transform: rotate(0deg);
        }

        .faq-icon.active {
            transform: rotate(90deg);
            color: #667eea;
        }

        .faq-answer {
            padding: 0 24px;
            color: #4b5563;
            line-height: 1.6;
            max-height: 0;
            overflow: hidden;
            transition: all 0.3s ease;
            background: #f9fafb;
            cursor: pointer;
        }

        .faq-answer.active {
            padding: 24px;
            max-height: 300px;
        }

        .faq-answer.expanded {
            padding: 32px;
            background: #f3f4f6;
        }

        footer {
            border-top: 1px solid #e5e7eb;
            padding: 40px 0;
            margin-top: 80px;
        }

        .footer-content {
            max-width: 600px;
            margin: 0 auto;
            text-align: center;
        }

        .footer-quote {
            font-size: 0.9rem;
            font-style: italic;
            line-height: 1.6;
            color: #6b7280;
            margin-bottom: 12px;
        }

        .footer-signature {
            font-size: 0.8rem;
            color: #9ca3af;
        }

        /* 动画类 */
        .rolling-animation {
            animation: rollingNumbers 1.5s ease-out forwards;
        }
        
        @keyframes rollingNumbers {
            0% { 
                transform: translateY(50px);
                opacity: 0;
            }
            100% { 
                transform: translateY(0);
                opacity: 1;
            }
        }
        
        .pulse {
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(37, 99, 235, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(37, 99, 235, 0); }
            100% { box-shadow: 0 0 0 0 rgba(37, 99, 235, 0); }
        }

        /* 数字滚动动画 */
        .counter {
            display: inline-block;
            transition: all 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        /* 加载动画 */
        .loading {
            opacity: 0.6;
            pointer-events: none;
        }

        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 20px;
                text-align: center;
            }

            .header-right {
                flex-direction: row;
                gap: 12px;
            }

            .header-left h1 {
                font-size: 1.8rem;
            }
            
            .calculator-section,
            .comparison-section,
            .faq-section {
                padding: 25px;
                margin: 20px 0;
            }
            
            .result-amount {
                font-size: 1.8rem;
            }
            
            .chart-container {
                height: 200px;
                padding: 20px 10px;
            }
            
            .chart-bar {
                width: 60px;
            }

            .results {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .faq-question {
                padding: 16px 20px;
                font-size: 1rem;
                grid-template-columns: 1fr 40px;
            }

            .faq-answer.active {
                padding: 20px;
            }

            .faq-answer.expanded {
                padding: 24px;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <div class="header-left">
                    <h1>💰 投资模拟器</h1>
                </div>
                <div class="header-right">
                    <button class="lang-toggle" onclick="toggleLanguage()">中/EN</button>
                    <div class="header-divider"></div>
                    <a href="https://github.com/Lizevolving/lil-investor" target="_blank" rel="noopener" class="github-link">
                        <i class="fab fa-github"></i>
                        <span>GitHub</span>
                    </a>
                </div>
            </div>
        </div>
    </header>

    <main>
        <div class="container">
            <!-- 计算器部分 -->
            <section class="calculator-section">
                <div class="input-group">
                    <label for="monthlyAmount">
                        <i class="fas fa-coins"></i> 每月定投金额 (元)
                    </label>
                    <input type="number" id="monthlyAmount" class="amount-input" value="1000" min="100" max="50000" step="100">
                </div>

                <div class="slider-container">
                    <label for="returnRate"><i class="fas fa-chart-line"></i> 年化收益率</label>
                    <div class="slider-wrapper">
                        <input type="range" id="returnRate" class="slider" min="1" max="20" value="8" step="0.5" 
                               title="调整年化收益率" aria-label="年化收益率滑块">
                        <div class="slider-value"><span id="rateDisplay">8.0</span>%</div>
                    </div>
                </div>

                <div class="results">
                    <div class="result-card">
                        <div class="result-title">📈 定投收益 (20年)</div>
                        <div class="result-amount rolling-animation" id="investmentResult">¥589,020</div>
                        <div class="result-desc">复利让时间成为你的朋友</div>
                    </div>
                    <div class="result-card savings">
                        <div class="result-title">🏦 活期存款 (20年)</div>
                        <div class="result-amount rolling-animation" id="savingsResult">¥247,297</div>
                        <div class="result-desc">按年化0.35%计算</div>
                    </div>
                    <div class="result-card speculation">
                        <div class="result-title">🎲 散户炒股 (20年)</div>
                        <div class="result-amount rolling-animation" id="speculationResult">¥180,000</div>
                        <div class="result-desc">平均亏损25%本金</div>
                    </div>
                </div>
            </section>

            <!-- 对比分析 -->
            <section class="comparison-section">
                <h2 class="comparison-title">📊 20年收益对比</h2>
                <div class="chart-container">
                    <div class="chart-bar" id="chartInvestment">
                        <div class="chart-label">定投</div>
                        <div class="chart-value" id="chartInvestmentValue">¥589,020</div>
                    </div>
                    <div class="chart-bar savings" id="chartSavings">
                        <div class="chart-label">存款</div>
                        <div class="chart-value" id="chartSavingsValue">¥247,297</div>
                    </div>
                    <div class="chart-bar speculation" id="chartSpeculation">
                        <div class="chart-label">炒股</div>
                        <div class="chart-value" id="chartSpeculationValue">¥180,000</div>
                    </div>
                </div>

                <div class="insights">
                    <div class="insights-title">
                        <i class="fas fa-lightbulb"></i>
                        数据洞察
                    </div>
                    <ul class="insights-list">
                        <li>定投收益是活期存款的<strong id="savingsMultiple">2.4</strong>倍</li>
                        <li>定投收益是散户炒股的<strong id="speculationMultiple">3.3</strong>倍</li>
                        <li>每月投资<strong id="monthlyDisplay">1000</strong>元，20年总投入<strong id="totalInvested">24万</strong>元</li>
                        <li>复利增值<strong id="compoundGain">34.9万</strong>元，增长率<strong id="growthRate">145%</strong></li>
                    </ul>
                </div>
            </section>

            <!-- FAQ 部分 -->
            <section class="faq-section">
                <h2 class="faq-title">💬 常见问题</h2>
                
                <div class="faq-item">
                    <button class="faq-question" onclick="toggleFAQ(this)">
                        <span>投资是什么？</span>
                        <i class="fas fa-chevron-right faq-icon"></i>
                    </button>
                    <div class="faq-answer" onclick="expandAnswer(this)">
                        投资是指将资金投入到能够产生收益的资产中，通过时间和复利效应实现财富增长。投资不是投机，而是理性配置资产，让钱为你工作。
                    </div>
                </div>

                <div class="faq-item">
                    <button class="faq-question" onclick="toggleFAQ(this)">
                        <span>为什么要投资？</span>
                        <i class="fas fa-chevron-right faq-icon"></i>
                    </button>
                    <div class="faq-answer" onclick="expandAnswer(this)">
                        通胀每年吞噬购买力约3%，而银行存款利率远低于此。不投资就是在变相亏损。投资是对抗通胀、实现财务自由的必要手段。
                    </div>
                </div>

                <div class="faq-item">
                    <button class="faq-question" onclick="toggleFAQ(this)">
                        <span>该怎么投资？</span>
                        <i class="fas fa-chevron-right faq-icon"></i>
                    </button>
                    <div class="faq-answer" onclick="expandAnswer(this)">
                        定投指数基金是最适合普通人的投资方式。选择低费率的宽基指数基金，每月固定投入，长期持有。避免频繁交易，时间是投资的朋友。
                    </div>
                </div>

                <div class="faq-item">
                    <button class="faq-question" onclick="toggleFAQ(this)">
                        <span>什么是房产？什么是基金？什么是股票？什么是比特币？</span>
                        <i class="fas fa-chevron-right faq-icon"></i>
                    </button>
                    <div class="faq-answer" onclick="expandAnswer(this)">
                        房产：实物资产，抗通胀，但流动性差、门槛高。基金：专业机构管理的资产组合，分散风险。股票：公司所有权份额，波动大但长期收益高。比特币：数字货币，高风险高收益，适合小额配置。
                    </div>
                </div>

                <div class="faq-item">
                    <button class="faq-question" onclick="toggleFAQ(this)">
                        <span>年化8%的收益率现实吗？</span>
                        <i class="fas fa-chevron-right faq-icon"></i>
                    </button>
                    <div class="faq-answer" onclick="expandAnswer(this)">
                        沪深300指数过去15年年化收益约9.2%，标普500指数过去30年年化收益约10%。考虑到市场波动，8%是相对保守且可实现的长期预期。
                    </div>
                </div>

                <div class="faq-item">
                    <button class="faq-question" onclick="toggleFAQ(this)">
                        <span>为什么散户炒股收益这么低？</span>
                        <i class="fas fa-chevron-right faq-icon"></i>
                    </button>
                    <div class="faq-answer" onclick="expandAnswer(this)">
                        统计显示90%散户长期亏损，主要原因：频繁交易产生高额手续费、追涨杀跌、缺乏专业知识、情绪化决策。定投能有效避免这些问题。
                    </div>
                </div>

                <div class="faq-item">
                    <button class="faq-question" onclick="toggleFAQ(this)">
                        <span>定投真的能平滑风险吗？</span>
                        <i class="fas fa-chevron-right faq-icon"></i>
                    </button>
                    <div class="faq-answer" onclick="expandAnswer(this)">
                        定投通过"平均成本法"，在市场低迷时买入更多份额，高涨时买入较少份额，长期看能有效平滑市场波动，降低投资风险。
                    </div>
                </div>

                <div class="faq-item">
                    <button class="faq-question" onclick="toggleFAQ(this)">
                        <span>应该选择什么基金进行定投？</span>
                        <i class="fas fa-chevron-right faq-icon"></i>
                    </button>
                    <div class="faq-answer" onclick="expandAnswer(this)">
                        建议选择宽基指数基金（如沪深300、中证500）或优质主动型基金。关键是低费率、业绩稳定、管理规范。切忌频繁更换基金。
                    </div>
                </div>

                <div class="faq-item">
                    <button class="faq-question" onclick="toggleFAQ(this)">
                        <span>市场暴跌时还要继续定投吗？</span>
                        <i class="fas fa-chevron-right faq-icon"></i>
                    </button>
                    <div class="faq-answer" onclick="expandAnswer(this)">
                        市场暴跌恰恰是定投的最佳时机！此时能以更低价格买入更多份额，为未来收益打下基础。巴菲特说："别人恐惧时我贪婪"。
                    </div>
                </div>
            </section>
        </div>
    </main>

    <footer>
        <div class="container">
            <div class="footer-content">
                <p class="footer-quote">
                    "数据是佛经，人性是红尘——这模拟器是木鱼，敲再响也未必能渡人，但总有人会顿悟。"
                </p>
            </div>
        </div>
    </footer>

    <script>
        // 计算器核心逻辑
        class InvestmentCalculator {
            constructor() {
                this.monthlyAmount = 1000;
                this.annualRate = 0.08;
                this.years = 20;
                this.savingsRate = 0.0035; // 活期存款年化收益
                this.speculationLoss = 0.25; // 散户平均亏损率
                
                this.initEventListeners();
                this.calculate();
            }

            initEventListeners() {
                const monthlyInput = document.getElementById('monthlyAmount');
                const rateSlider = document.getElementById('returnRate');
                
                monthlyInput.addEventListener('input', (e) => {
                    this.monthlyAmount = parseFloat(e.target.value) || 1000;
                    this.calculate();
                });

                rateSlider.addEventListener('input', (e) => {
                    const rate = parseFloat(e.target.value);
                    this.annualRate = rate / 100;
                    document.getElementById('rateDisplay').textContent = rate.toFixed(1);
                    this.calculate();
                });
            }

            // 复利计算公式
            calculateCompoundInvestment() {
                const monthlyRate = this.annualRate / 12;
                const totalMonths = this.years * 12;
                
                if (monthlyRate === 0) {
                    return this.monthlyAmount * totalMonths;
                }
                
                // FV = PMT × [((1 + r)^n - 1) / r]
                return this.monthlyAmount * (Math.pow(1 + monthlyRate, totalMonths) - 1) / monthlyRate;
            }

            calculateSavings() {
                const monthlyRate = this.savingsRate / 12;
                const totalMonths = this.years * 12;
                
                if (monthlyRate === 0) {
                    return this.monthlyAmount * totalMonths;
                }
                
                return this.monthlyAmount * (Math.pow(1 + monthlyRate, totalMonths) - 1) / monthlyRate;
            }

            calculateSpeculation() {
                const totalInvested = this.monthlyAmount * this.years * 12;
                return totalInvested * (1 - this.speculationLoss);
            }

            formatCurrency(amount) {
                return '¥' + amount.toLocaleString('zh-CN', {
                    minimumFractionDigits: 0,
                    maximumFractionDigits: 0
                });
            }

            animateValue(element, start, end, duration = 1000) {
                if (start === end) return;
                
                // 添加滚动动画类
                element.classList.add('rolling-animation');
                
                const startTimestamp = performance.now();
                const step = (timestamp) => {
                    const elapsed = timestamp - startTimestamp;
                    const progress = Math.min(elapsed / duration, 1);
                    
                    // 使用缓动函数
                    const easeOutQuart = 1 - Math.pow(1 - progress, 4);
                    const current = start + (end - start) * easeOutQuart;
                    
                    element.textContent = this.formatCurrency(current);
                    
                    if (progress < 1) {
                        requestAnimationFrame(step);
                    } else {
                        // 动画完成后移除动画类
                        setTimeout(() => {
                            element.classList.remove('rolling-animation');
                        }, 100);
                    }
                };
                requestAnimationFrame(step);
            }

            updateChartBar(barId, value, maxValue) {
                const bar = document.getElementById(barId);
                const height = (value / maxValue) * 200; // 最大高度200px
                bar.style.height = height + 'px';
            }

            calculate() {
                const investmentTotal = this.calculateCompoundInvestment();
                const savingsTotal = this.calculateSavings();
                const speculationTotal = this.calculateSpeculation();
                const totalInvested = this.monthlyAmount * this.years * 12;

                // 动画更新数值
                const investmentEl = document.getElementById('investmentResult');
                const savingsEl = document.getElementById('savingsResult');
                const speculationEl = document.getElementById('speculationResult');
                
                // 获取当前值用于动画
                const currentInvestment = parseFloat(investmentEl.textContent.replace(/[¥,]/g, '')) || 0;
                const currentSavings = parseFloat(savingsEl.textContent.replace(/[¥,]/g, '')) || 0;
                const currentSpeculation = parseFloat(speculationEl.textContent.replace(/[¥,]/g, '')) || 0;

                this.animateValue(investmentEl, currentInvestment, investmentTotal);
                this.animateValue(savingsEl, currentSavings, savingsTotal);
                this.animateValue(speculationEl, currentSpeculation, speculationTotal);

                // 更新图表
                const maxValue = Math.max(investmentTotal, savingsTotal, speculationTotal);
                setTimeout(() => {
                    this.updateChartBar('chartInvestment', investmentTotal, maxValue);
                    this.updateChartBar('chartSavings', savingsTotal, maxValue);
                    this.updateChartBar('chartSpeculation', speculationTotal, maxValue);
                    
                    // 更新图表数值
                    document.getElementById('chartInvestmentValue').textContent = this.formatCurrency(investmentTotal);
                    document.getElementById('chartSavingsValue').textContent = this.formatCurrency(savingsTotal);
                    document.getElementById('chartSpeculationValue').textContent = this.formatCurrency(speculationTotal);
                }, 200);

                // 更新洞察数据
                const savingsMultiple = (investmentTotal / savingsTotal).toFixed(1);
                const speculationMultiple = (investmentTotal / speculationTotal).toFixed(1);
                const compoundGain = investmentTotal - totalInvested;
                const growthRate = ((compoundGain / totalInvested) * 100).toFixed(0);

                document.getElementById('savingsMultiple').textContent = savingsMultiple;
                document.getElementById('speculationMultiple').textContent = speculationMultiple;
                document.getElementById('monthlyDisplay').textContent = this.monthlyAmount.toLocaleString();
                document.getElementById('totalInvested').textContent = (totalInvested / 10000).toFixed(0) + '万';
                document.getElementById('compoundGain').textContent = (compoundGain / 10000).toFixed(1) + '万';
                document.getElementById('growthRate').textContent = growthRate + '%';
            }
        }

        // FAQ 最佳实践交互
        function toggleFAQ(element) {
            const answer = element.nextElementSibling;
            const icon = element.querySelector('.faq-icon');
            
            // 关闭其他已打开的FAQ
            const allAnswers = document.querySelectorAll('.faq-answer');
            const allIcons = document.querySelectorAll('.faq-icon');
            
            allAnswers.forEach((ans, index) => {
                if (ans !== answer && ans.classList.contains('active')) {
                    ans.classList.remove('active');
                    ans.style.maxHeight = '0';
                    allIcons[index].classList.remove('active');
                }
            });
            
            // 切换当前FAQ
            if (answer.classList.contains('active')) {
                answer.classList.remove('active');
                answer.style.maxHeight = '0';
                icon.classList.remove('active');
            } else {
                answer.classList.add('active');
                answer.style.maxHeight = answer.scrollHeight + 'px';
                icon.classList.add('active');
            }
        }

        // 答案区域点击扩展
        function expandAnswer(element) {
            if (element.classList.contains('active')) {
                element.classList.toggle('expanded');
            }
        }

        // 语言切换功能（占位符）
        function toggleLanguage() {
            alert('语言切换功能待实现');
        }

        // 键盘导航支持
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' || e.key === ' ') {
                const activeElement = document.activeElement;
                if (activeElement.classList.contains('faq-question')) {
                    e.preventDefault();
                    toggleFAQ(activeElement);
                }
            }
        });

        // 页面加载完成后初始化计算器
        document.addEventListener('DOMContentLoaded', () => {
            new InvestmentCalculator();
        });

        // 页面滚动动画效果
        function handleScrollAnimation() {
            const elements = document.querySelectorAll('.result-card, .chart-bar');
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.style.opacity = '1';
                        entry.target.style.transform = 'translateY(0)';
                    }
                });
            }, { threshold: 0.1 });

            elements.forEach(el => {
                el.style.opacity = '0';
                el.style.transform = 'translateY(20px)';
                el.style.transition = 'all 0.6s ease';
                observer.observe(el);
            });
        }

        // 初始化动画
        document.addEventListener('DOMContentLoaded', handleScrollAnimation);
    </script>
</body>
</html> 